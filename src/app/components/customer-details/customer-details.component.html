<div class="container list">
    <div *ngIf="customer">
      <div class="d-flex justify-content-between align-items-center">
        <h3>{{ customer.customerName }}</h3>
        <!-- Dowbload Record -->
        <div *ngIf="showHistory && customer.ledger?.length" class="btn btn-warning" (click)="downloadPDF()">Download Record</div>
        <!-- Toggle Button for Viewing History -->
        <button class="btn btn-secondary" (click)="toggleHistory()">
          {{ showHistory ? 'Hide History' : 'View History' }}
        </button>
      </div>
  
      <!-- Show elements only when history is hidden -->
      <div *ngIf="!showHistory">
        <div class="row my-4">
          <div class="col-lg-4">
            <h5>Payment to Customer:</h5>
            <div class="input-group mb-3">
              <input [(ngModel)]="addDebCred.debit" type="text" class="form-control input-debit" placeholder="Enter debit amount">
              <button class="btn btn-outline-primary" type="button" (click)="debit()">Debit</button>
            </div>
          </div>
          <div class="col-lg-4">
            <h5>Payment from Customer:</h5>
            <div class="input-group mb-3">
              <input [(ngModel)]="addDebCred.credit" type="text" class="form-control input-credit" placeholder="Enter credit amount">
              <button class="btn btn-outline-primary" type="button" (click)="credit()">Credit</button>
            </div>
          </div>
        </div>
  
        <table class="table table-bordered table-striped table-dark mb-3">
          <thead>
            <tr class="text-center">
              <th style="width: 20%;">Sr. No</th>
              <th style="width: 30%;">Product Name<span class="text-danger">*</span></th>
              <th style="width: 25%;">Product Price<span class="text-danger">*</span></th>
              <th style="width: 25%;">Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let row of productRows; let i = index" class="text-center">
              <td>{{ i + 1 }}</td>
              <td>
                <select class="form-control" [(ngModel)]="row.selectedProductId">
                  <option value="" disabled selected><label>Select Product</label></option>
                  <option *ngFor="let product of ProductsList" [ngValue]="product.id">{{ product.name }}</option>
                </select>
              </td>
              <td>
                <input [(ngModel)]="row.price" class="form-control" placeholder="Enter Price" />
              </td>
              <td>
                <div class="btn btn-danger" (click)="removeProductRow(i)">Remove</div>
              </td>
            </tr>
            <tr *ngIf="productRows.length" class="text-center">
              <td colspan="2">Total Price</td>
              <td colspan="2">{{ getTotalSum() }}</td>
            </tr>
          </tbody>
        </table>
        <div class="btn btn-info mt-2" (click)="addProductRow()">Add Product</div>
        <div class="btn btn-warning mt-2 ms-3" (click)="updateRecord()">Update Record</div>
      </div>
  
      <!-- Show history table only when history is visible -->
      <div *ngIf="showHistory && customer.ledger?.length" class="mt-3">
        <table id="table" class="table table-bordered table-striped table-dark">
          <thead>
            <tr class="text-center">
              <th style="width: 15%;">Date</th>
              <th style="width: 25%;">Product Name</th>
              <th style="width: 15%;">Rate</th>
              <th style="width: 15%;">Debit</th>
              <th style="width: 15%;">Credit</th>
              <th style="width: 15%;">Balance</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let entry of customer.ledger" class="text-center">
              <td>{{ entry.date | date: 'short' }}</td>
              <td>
                {{ entry.products ? joinProductNames(entry.products) : 'Credit/Debit' }}
              </td>
              <td>{{ entry.totalPrice || '' }}</td>
              <td>{{ entry.debit || '' }}</td>
              <td>{{ entry.credit || '' }}</td>
              <td>{{ entry.balance }}</td>
            </tr>
          </tbody>
        </table>
      </div>

<!-- Show message if no transactions are available -->
<div *ngIf="showHistory && !customer.transactions?.length" class="mt-3 center-load">
  <h3>No Transaction Available...</h3>
</div>


  
    <!-- <div *ngIf="!customer">
      <h1>Loading...</h1>
      <p>Please Check your Internet Connection</p>
    </div>
  </div> -->
  